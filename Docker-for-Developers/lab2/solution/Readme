To deploy tomcattest for routing mesh testing for both ports 80 and 443(8443) you will need to build the image and store it in DTR, once that is complete you would deploy the stack. Follow the steps below:

 
   1. Unzip the attached tomcattest.gztar file or 
      clone https://bitbucket.mutualofomaha.com/projects/VCS/repos/docker/browse/apps?at=refs%2Fheads%2Fprovision
   
   2. Get and unzip the bundle from the new swarm.
      a. Log into ucp on the new swarm
      b. Select user (from left pain) -> My Profile -> New Client Bundle
      c. Unzip the downloaded boundle file.

   3. Source the correct env file.
   
   4. Cd into tomcat-ssl dir created in step 1
   
   5. Build the image (You will need to change docker-dtr-lab2 to the new swarm)
      a. docker build –t docker-dtr-lab2.mutualofomaha.com/mutualofomaha/tomcat:8.0.ssl .

   6. Push image to DTR (You will need to change docker-dtr-lab2 to the new swarm)
      a. docker push docker-dtr-lab2.mutualofomaha.com/mutualofomaha/tomcat:8.0.ssl

   7. Deploy the stack
      a. docker stack deploy -c docker-stack.yml tomcattest

   8. Add /change “tomcattest.mutualofomaha.com” in dns and point it to the new swarm apps load balancer.

   9. Access the site from a web browser. The following urls should display the tomcat home page.
      a. http://tomcattest.mutalofomaha.com
      b. https://tomcattest.mutalofomaha.com

   10. To remove the stack

      a. docker stack rm tomcattest
